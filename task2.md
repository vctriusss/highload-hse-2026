# Расчет нагрузки

- MAU - 58 млн
- DAU - 5 млн
- Среднее время подачи - 6 минут
- Средняя длина маршрута - 8.7 км.
- Среднее число пользователей одновременно - 10 тыс.

## Дисковое пространство

При средней скорости автомобиля 30 км/ч, тогда в среднем поезка длится 18 минут.

Допустим пишем геолокацию на маршруте раз в 2 секунды. Тогда за 1 поездку в среднем сохраняем данные по (18 + 6) * 60 / 2 = 720 точкам. Допустим можно закодировать точку в 100 Байт (с учетом timestamp).

Тогда в среднем поездка "весит" 100b * 720 = 72 Kb.

Тогда в день используется 5.000.000 x 72 Kb = 360 Gb дискового пространства. Тогда в год необходимо 360 Gb x 365 = 128 Tb. С учетом репликации (2 копии), будет 384 Tb в год.

Также заложим место под данные пользователей и водителей (ФИО, телефон, сохраненные адреса) - 100 Kb. Тогда под это заложено 5.8 Gb. С учетом репликации 17 Gb.

Еще выделим место под логи - примерно эквивалентно суммарному трафику.

## RPS

Одновременно в приложении находятся 10 тысяч пользователей. 

Тогда RPS на surge - 10k.

В отображении геолокации запрашиваем позицию раз в 2 секунды. Тогда RPS на показ геолокации - 5k. Но при этом водитель также смотрит свою геолокацию. Тогда итоговый RPS геолокации 5k * 2 = 10k

Допустим, в 1 случае из 3, пользователи создают заказ. Тога RPS создания заказа будет 3k.

Согласно [источнику](https://ria.ru/20240904/jandeks-1970393459.html) в Такси работает 1 млн водителей. Если в среднем водитель работает 3 дня в неделю, то одновременно на смене находятся 400 тысяч водителей.

Тогда при средней продолжительности смены 8 часов, получаем RPS ручку смен (выход, пауза, завершение) 400.000 * 3 / 8 / 3600 = 42. 

## Сводная таблица

|Показатель|Значение|
|---|---|
|Диск (поездки) |384 Tb/год|
|Диск (данные) | 17 Gb |
|Сеть||
|RPS главной | 10k |
|RPS геолокация| 10k |
|RPS создания заказа | 3k |
|RPS смен | 42 |
